{"version":3,"file":"brew-auth.js","mappings":"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","sources":["webpack://brew-extension-auth/webpack/universalModuleDefinition","webpack://brew-extension-auth/external umd {\"commonjs\":\"brew-js\",\"commonjs2\":\"brew-js\",\"amd\":\"brew-js\",\"root\":\"brew\"}","webpack://brew-extension-auth/external umd {\"commonjs\":\"zeta-dom\",\"commonjs2\":\"zeta-dom\",\"amd\":\"zeta-dom\",\"root\":\"zeta\"}","webpack://brew-extension-auth/webpack/bootstrap","webpack://brew-extension-auth/webpack/runtime/define property getters","webpack://brew-extension-auth/webpack/runtime/hasOwnProperty shorthand","webpack://brew-extension-auth/webpack/runtime/make namespace object","webpack://brew-extension-auth/../brew-extension-auth|umd|C:/brew-js/app.js","webpack://brew-extension-auth/../brew-extension-auth|umd|C:/brew-js/util/path.js","webpack://brew-extension-auth/../brew-extension-auth|umd|C:/zeta-dom/util.js","webpack://brew-extension-auth/../brew-extension-auth|umd|C:/zeta-dom/dom.js","webpack://brew-extension-auth/./src/errorCode.js","webpack://brew-extension-auth/./src/extension.js","webpack://brew-extension-auth/../brew-extension-auth|umd|C:/zeta-dom/domUtil.js","webpack://brew-extension-auth/./src/provider.js","webpack://brew-extension-auth/./src/middleware.js","webpack://brew-extension-auth/../brew-extension-auth|umd|C:/brew-js/errorCode.js","webpack://brew-extension-auth/./src/util/JSONClient.js","webpack://brew-extension-auth/./src/util.js","webpack://brew-extension-auth/./src/index.js","webpack://brew-extension-auth/./src/entry.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"brew-js\"), require(\"zeta-dom\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"@misonou/brew-extension-auth\", [\"brew-js\", \"zeta-dom\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Auth\"] = factory(require(\"brew-js\"), require(\"zeta-dom\"));\n\telse\n\t\troot[\"brew\"] = root[\"brew\"] || {}, root[\"brew\"][\"Auth\"] = factory(root[\"brew\"], root[\"zeta\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE__760__, __WEBPACK_EXTERNAL_MODULE__231__) {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__760__;","module.exports = __WEBPACK_EXTERNAL_MODULE__231__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import lib from \"brew-js\";\r\nconst { addExtension } = lib;\r\nexport { addExtension };","import lib from \"brew-js\";\r\nconst { combinePath } = lib;\r\nexport { combinePath };","import lib from \"zeta-dom\";\r\nconst { catchAsync, defineHiddenProperty, defineObservableProperty, each, errorWithCode, exclude, extend, is, isErrorWithCode, isFunction, makeArray, makeAsync, mapRemove, pick, pipe, reject, resolve, resolveAll, throws } = lib.util;\r\nexport { catchAsync, defineHiddenProperty, defineObservableProperty, each, errorWithCode, exclude, extend, is, isErrorWithCode, isFunction, makeArray, makeAsync, mapRemove, pick, pipe, reject, resolve, resolveAll, throws };","import lib from \"zeta-dom\";\r\nconst { reportError } = lib.dom;\r\nexport { reportError };","export const loggedIn = 'brew/auth-logged-in';\r\nexport const noProvider = 'brew/auth-no-provider';\r\nexport const invalidCredential = 'brew/auth-invalid-credential';\r\n","import { addExtension } from \"brew-js/app\";\r\nimport { combinePath } from \"brew-js/util/path\";\r\nimport { catchAsync, defineObservableProperty, errorWithCode, extend, isErrorWithCode, isFunction, makeArray, makeAsync, mapRemove, pick, pipe, reject, resolve, resolveAll, throws } from \"zeta-dom/util\";\r\nimport { reportError } from \"zeta-dom/dom\";\r\nimport * as AuthError from \"./errorCode.js\";\r\n\r\nconst CACHE_KEY = 'brew.auth';\r\n\r\nexport default addExtension('auth', ['router'], function (app, options) {\r\n    var setUser = defineObservableProperty(app, 'user', null, true);\r\n    var providers = makeArray(options.providers || options.provider);\r\n    var providerParams = {\r\n        interaction: options.interaction || 'redirect',\r\n    };\r\n    var contexts = new Map();\r\n    var redirectUri = combinePath(location.origin, app.toHref('/'));\r\n    var sessionCache = app.cache;\r\n    var currentProvider;\r\n    var currentResult;\r\n\r\n    function initProvider(provider) {\r\n        var context = {\r\n            redirectUri: redirectUri,\r\n            revokeSession: function (accountId) {\r\n                if (currentProvider === provider && (!accountId || currentResult.accountId === accountId)) {\r\n                    currentProvider = null;\r\n                    if (!app.emit('sessionEnded')) {\r\n                        handleLogout();\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        contexts.set(provider, context);\r\n        return resolve(provider.init(context)).catch(function (e) {\r\n            if (!isErrorWithCode(e, AuthError.invalidCredential)) {\r\n                reportError(e);\r\n            }\r\n        });\r\n    }\r\n\r\n    function filterByProp(arr, key, value) {\r\n        return value === undefined ? arr : arr.filter(function (v) {\r\n            return v[key] === value;\r\n        });\r\n    }\r\n\r\n    function findProvider(params) {\r\n        if (params.provider) {\r\n            return filterByProp(providers, 'key', params.provider)[0];\r\n        }\r\n        var matched = providers;\r\n        matched = filterByProp(matched, 'authType', params.authType);\r\n        matched = filterByProp(matched, 'providerType', params.providerType);\r\n        if (params.loginHint) {\r\n            return resolve(0).then(function next(index) {\r\n                var provider = matched[index];\r\n                return provider && resolve(provider.isHandleable(params.loginHint)).then(function (v) {\r\n                    return v ? provider : next(index + 1);\r\n                });\r\n            });\r\n        }\r\n        if (!matched[1]) {\r\n            return matched[0];\r\n        }\r\n    }\r\n\r\n    function setSessionState(provider, returnPath) {\r\n        sessionCache.set(CACHE_KEY, { provider, returnPath });\r\n    }\r\n\r\n    function popSessionState(provider) {\r\n        var state = mapRemove(sessionCache, CACHE_KEY) || {};\r\n        if (state.provider === provider) {\r\n            catchAsync(app.navigate(state.returnPath));\r\n        }\r\n    }\r\n\r\n    function handleLogin(provider, result) {\r\n        var data = {\r\n            provider: provider.key,\r\n            providerType: provider.providerType,\r\n            account: result.account\r\n        };\r\n        currentProvider = provider;\r\n        currentResult = result;\r\n        return (options.resolveUser ? makeAsync(options.resolveUser)(data) : resolve(data.account)).then(function (user) {\r\n            setUser(user);\r\n            popSessionState(provider.key);\r\n            app.emit('login', { user });\r\n        }, function (error) {\r\n            handleLogout();\r\n            throw error;\r\n        });\r\n    }\r\n\r\n    function handleLogout() {\r\n        var user = app.user;\r\n        currentProvider = null;\r\n        currentResult = null;\r\n        setUser(null);\r\n        popSessionState('');\r\n        if (user) {\r\n            app.emit('logout', { user });\r\n        }\r\n    }\r\n\r\n    function callProvider(provider, method, params, callback) {\r\n        var promise = makeAsync(provider[method]).call(provider, extend({}, providerParams, params), contexts.get(provider));\r\n        promise.catch(function () {\r\n            sessionCache.delete(CACHE_KEY);\r\n        });\r\n        return promise.then(callback);\r\n    }\r\n\r\n    app.define({\r\n        resolveAuthProvider: function (params) {\r\n            return resolve(findProvider(params)).then(function (provider) {\r\n                return provider ? pick(provider, ['key', 'authType', 'providerType']) : null;\r\n            });\r\n        },\r\n        acquireToken: function (callback) {\r\n            var provider = currentProvider;\r\n            var result = currentResult;\r\n            var force = callback === true;\r\n            callback = isFunction(callback) || resolve;\r\n            if (!provider) {\r\n                return callback(null, false);\r\n            }\r\n            if (!force && currentResult.expiresOn > Date.now()) {\r\n                return callback(currentResult.accessToken, true);\r\n            }\r\n            return provider.refresh(currentResult, contexts.get(provider)).then(function (result) {\r\n                if (currentProvider === provider) {\r\n                    currentResult = result;\r\n                }\r\n                return callback(result.accessToken, false);\r\n            }, function (error) {\r\n                return force ? throws(error) : callback(result.accessToken, false);\r\n            });\r\n        },\r\n        login: function (params) {\r\n            if (currentProvider) {\r\n                return reject(errorWithCode(AuthError.loggedIn));\r\n            }\r\n            params = params || {};\r\n            return resolve(findProvider(params)).then(function (provider) {\r\n                if (!provider) {\r\n                    throw errorWithCode(AuthError.noProvider);\r\n                }\r\n                setSessionState(provider.key, params.returnPath || options.postLoginPath || app.path);\r\n                return callProvider(provider, 'login', pick(params, ['loginHint', 'password']), handleLogin.bind(0, provider));\r\n            });\r\n        },\r\n        logout: function (params) {\r\n            if (!currentProvider) {\r\n                return resolve(handleLogout());\r\n            }\r\n            params = params || {};\r\n            setSessionState('', params.returnPath || options.postLogoutPath || app.path);\r\n            return callProvider(currentProvider, 'logout', {\r\n                accountId: currentResult.accountId,\r\n                singleLogout: params.singleLogout\r\n            }, handleLogout);\r\n        }\r\n    });\r\n\r\n    app.beforeInit(function () {\r\n        return resolveAll(providers.map(initProvider), function (results) {\r\n            var index = providers.indexOf(findProvider(sessionCache.get(CACHE_KEY) || {}));\r\n            if (!results[index]) {\r\n                index = results.findIndex(pipe);\r\n            }\r\n            return index >= 0 ? handleLogin(providers[index], results[index]) : handleLogout();\r\n        });\r\n    });\r\n});\r\n","import lib from \"zeta-dom\";\r\nconst { bind } = lib.util;\r\nexport { bind };","import { bind } from \"zeta-dom/domUtil\";\r\nimport { exclude } from \"zeta-dom/util\";\r\n\r\nconst AuthProvider = {\r\n    from: function (key, client) {\r\n        var storage = window.localStorage;\r\n        var storageKey = 'brew.auth.' + key;\r\n        var storageKeyID = storageKey + '.id';\r\n\r\n        function getCachedData() {\r\n            try {\r\n                return JSON.parse(storage[storageKey]);\r\n            } catch (e) { }\r\n        }\r\n\r\n        function setCurrentData(data) {\r\n            if (data) {\r\n                storage[storageKey] = JSON.stringify(exclude(data, ['account']));\r\n                storage[storageKeyID] = data.accountId;\r\n            } else {\r\n                delete storage[storageKey];\r\n                delete storage[storageKeyID];\r\n            }\r\n            return data;\r\n        }\r\n\r\n        return {\r\n            key: key,\r\n            authType: client.authType,\r\n            providerType: client.providerType,\r\n            init: function (context) {\r\n                bind(window, 'storage', function (e) {\r\n                    if (e.storageArea === storage && ((e.key === storageKeyID && e.oldValue) || e.key === null)) {\r\n                        context.revokeSession(e.oldValue);\r\n                    }\r\n                });\r\n                var cached = getCachedData();\r\n                return cached && client.refresh(cached).then(setCurrentData);\r\n            },\r\n            login: function (params) {\r\n                return client.login(params).then(setCurrentData);\r\n            },\r\n            logout: function (params) {\r\n                return client.logout(params).then(setCurrentData.bind(0, undefined));\r\n            },\r\n            refresh: function (cached) {\r\n                return client.refresh(cached).then(setCurrentData);\r\n            },\r\n            isHandleable: function (loginHint) {\r\n                return client.isHandleable(loginHint);\r\n            }\r\n        };\r\n    }\r\n};\r\nexport default AuthProvider;\r\n","import { is, isFunction, reject } from \"zeta-dom/util\";\r\n\r\nconst HEADER_AUTHORIZATION = 'authorization';\r\n\r\nfunction retryOrEnd(acquireToken, response, retryable, callback, onError) {\r\n    return retryable && response && response.status === 401 ? acquireToken(true).then(callback, onError) : onError();\r\n}\r\n\r\nfunction fetchMiddleware(acquireToken, filter, request, next) {\r\n    if (!is(request, Request) || (next && !isFunction(next))) {\r\n        return fetchMiddleware(acquireToken, filter, new Request(request, next));\r\n    }\r\n    next = next || window.fetch;\r\n    if ((filter && !filter(request)) || request.headers.has(HEADER_AUTHORIZATION)) {\r\n        return next(request);\r\n    }\r\n    return acquireToken(function execute(accessToken, retryable) {\r\n        var req = request;\r\n        if (accessToken) {\r\n            req = req.clone();\r\n            req.headers.set(HEADER_AUTHORIZATION, 'Bearer ' + accessToken);\r\n        }\r\n        return next(req).then(function (response) {\r\n            return retryOrEnd(acquireToken, response, retryable, execute, function () {\r\n                return response;\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\nfunction axiosMiddleware(acquireToken, filter, axios) {\r\n    var handled = new WeakMap();\r\n    var withBearerToken = function (config, accessToken) {\r\n        config.headers[HEADER_AUTHORIZATION] = 'Bearer ' + accessToken;\r\n        return config;\r\n    };\r\n    axios.interceptors.request.use(function (config) {\r\n        if ((filter && !filter(config)) || config.headers[HEADER_AUTHORIZATION]) {\r\n            return config;\r\n        }\r\n        return acquireToken(function (accessToken, retryable) {\r\n            handled.set(config, retryable);\r\n            return accessToken ? withBearerToken(config, accessToken) : config;\r\n        });\r\n    });\r\n    axios.interceptors.response.use(undefined, function (error) {\r\n        error = error || {};\r\n        return retryOrEnd(acquireToken, error.response, handled.get(error.config), function (accessToken) {\r\n            return axios.create()(withBearerToken(error.config, accessToken));\r\n        }, function () {\r\n            return reject(error);\r\n        });\r\n    });\r\n    return axios;\r\n}\r\n\r\nexport function createFetchMiddleware(app, filter) {\r\n    return fetchMiddleware.bind(0, app.acquireToken, filter);\r\n}\r\n\r\nexport function createAxiosMiddleware(app, filter) {\r\n    return axiosMiddleware.bind(0, app.acquireToken, filter);\r\n}\r\n","import lib from \"brew-js\";\r\nconst errorCode = lib.ErrorCode;\r\nconst { apiError } = errorCode;\r\nexport { apiError };","import { defineHiddenProperty, each, errorWithCode, extend, is } from \"zeta-dom/util\";\r\nimport { combinePath } from \"brew-js/util/path\";\r\nimport * as BrewError from \"brew-js/errorCode\";\r\n\r\nfunction getOptionsWithBody(method, body, options) {\r\n    options = options || {};\r\n    return extend({}, options, {\r\n        method: method,\r\n        body: JSON.stringify(body),\r\n        headers: extend({}, options.headers, {\r\n            'content-type': 'application/json'\r\n        })\r\n    });\r\n}\r\n\r\nfunction handleResult(response, data, error) {\r\n    if (response.ok) {\r\n        return data;\r\n    }\r\n    throw errorWithCode(BrewError.apiError, '', {\r\n        data: data,\r\n        error: error || null,\r\n        status: response.status\r\n    });\r\n}\r\n\r\nfunction fetchJSON(request, next) {\r\n    request.headers.set('accept', 'application/json');\r\n    return (next || fetch)(request).then(function (response) {\r\n        return response.json().then(function (data) {\r\n            return handleResult(response, data);\r\n        }, function (e) {\r\n            // assume empty for non-JSON response with 2xx status\r\n            return handleResult(response, null, e);\r\n        });\r\n    });\r\n}\r\n\r\nfunction JSONClient(baseUrl, middleware) {\r\n    middleware = middleware || function (request, next) {\r\n        return next(request);\r\n    };\r\n    this.baseUrl = baseUrl;\r\n    this.request = function (request, options) {\r\n        request = is(request, Request) || new Request(combinePath(baseUrl, request), options);\r\n        return middleware(request, fetchJSON);\r\n    };\r\n}\r\n\r\neach('get post put patch delete', function (i, v) {\r\n    var method = v.toUpperCase();\r\n    defineHiddenProperty(JSONClient.prototype, v, function (path, body, options) {\r\n        return this.request(path, v === 'get' ? body : getOptionsWithBody(method, body, options));\r\n    });\r\n});\r\n\r\nexport default JSONClient;\r\n","import JSONClient from \"./util/JSONClient.js\";\r\n\r\nexport {\r\n    JSONClient\r\n}\r\n","import Auth from \"./extension.js\";\r\nimport * as AuthError from \"./errorCode.js\";\r\nimport AuthProvider from \"./provider.js\";\r\n\r\nexport default Auth;\r\nexport * from \"./middleware.js\";\r\nexport * from \"./util.js\";\r\n\r\nexport {\r\n    AuthError,\r\n    AuthProvider\r\n}\r\n","import Auth from \"./index.js\";\r\nimport * as methods from \"./index.js\";\r\n\r\nObject.assign(Auth, methods);\r\nexport default Auth;\r\n"],"names":["lib","addExtension","combinePath","_lib$util","util","catchAsync","defineHiddenProperty","defineObservableProperty","each","errorWithCode","exclude","extend","is","isErrorWithCode","isFunction","makeArray","makeAsync","mapRemove","pick","pipe","reject","resolve","resolveAll","throws","reportError","dom","loggedIn","noProvider","invalidCredential","AuthError","CACHE_KEY","app","options","setUser","providers","provider","providerParams","interaction","contexts","Map","redirectUri","location","origin","toHref","sessionCache","cache","currentProvider","currentResult","initProvider","context","revokeSession","accountId","emit","handleLogout","set","init","e","filterByProp","arr","key","value","undefined","filter","v","findProvider","params","matched","authType","providerType","loginHint","then","next","index","isHandleable","setSessionState","returnPath","popSessionState","state","navigate","handleLogin","result","data","account","resolveUser","user","error","callProvider","method","callback","promise","call","get","define","resolveAuthProvider","acquireToken","force","expiresOn","Date","now","accessToken","refresh","login","postLoginPath","path","bind","logout","postLogoutPath","singleLogout","beforeInit","map","results","indexOf","findIndex","AuthProvider","from","client","storage","window","localStorage","storageKey","storageKeyID","getCachedData","JSON","parse","setCurrentData","stringify","storageArea","oldValue","cached","HEADER_AUTHORIZATION","retryOrEnd","response","retryable","onError","status","fetchMiddleware","request","Request","fetch","headers","has","execute","req","clone","axiosMiddleware","axios","handled","WeakMap","withBearerToken","config","interceptors","use","create","createFetchMiddleware","createAxiosMiddleware","errorCode","ErrorCode","apiError","BrewError","getOptionsWithBody","body","handleResult","ok","fetchJSON","json","JSONClient","baseUrl","middleware","i","toUpperCase","prototype","Auth","methods","Object","assign"],"sourceRoot":""}